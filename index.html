<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cv Forge AI | Full Auto-Translate</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root { --primary: #0f172a; --accent: #38bdf8; --bg: #f1f5f9; --border: #e2e8f0; }
        body { margin: 0; background: var(--bg); font-family: 'Cairo', sans-serif; color: #1e293b; }
        header { padding: 15px 30px; background: white; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .app-wrapper { max-width: 900px; margin: 30px auto; padding: 0 20px; }
        .card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px; }
        label { display: block; font-weight: 700; font-size: 12px; color: #64748b; margin-bottom: 5px; }
        input, textarea, select { width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; outline: none; font-family: inherit; }
        input:focus { border-color: var(--accent); }

        .dl-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; margin-top: 25px; }
        .btn { border: none; padding: 12px; border-radius: 10px; color: white; font-weight: 800; cursor: pointer; transition: 0.3s; font-size: 12px; }
        .ar { background: #1e293b; } .en { background: #0284c7; } .fr { background: #e11d48; } 
        .it { background: #16a34a; } .es { background: #ea580c; } .de { background: #4b5563; }
        .btn:hover { opacity: 0.8; transform: translateY(-2px); }

        /* PDF Styles */
        #pdf-render { position: absolute; top: -10000px; left: -10000px; width: 210mm; display: flex; background: white; }
        .pdf-side { width: 75mm; background: #1e293b; color: white; padding: 30px 20px; min-height: 297mm; }
        .pdf-main { flex: 1; padding: 40px; }
        .pdf-h { font-size: 18px; font-weight: 900; color: #0f172a; border-left: 4px solid #38bdf8; padding-left: 10px; margin: 25px 0 10px; }
        .rtl { direction: rtl; } .ltr { direction: ltr; }
        .ltr .pdf-h { border-left: none; border-right: 4px solid #38bdf8; padding-right: 10px; text-align: left; }

        #overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); z-index: 9999; align-items: center; justify-content: center; color: white; flex-direction: column; }
    </style>
</head>
<body>

<div id="overlay">
    <i class="fas fa-spinner fa-spin fa-3x"></i>
    <h2 id="wait-msg">جاري الترجمة الفورية والتحميل...</h2>
</div>

<header>
    <div style="font-weight:900; font-size:20px;"><i class="fas fa-robot text-accent"></i> CV<span>FORGE</span> AI</div>
</header>

<div class="app-wrapper">
    <div class="card">
        <div class="grid">
            <div><label>الاسم الكامل</label><input type="text" id="inName" class="req"></div>
            <div><label>المسمى الوظيفي</label><input type="text" id="inJob" class="req" oninput="runAI()"></div>
            <div><label>سنين الخبرة</label><input type="number" id="inExpYears" oninput="runAI()"></div>
        </div>
        <div class="grid">
            <div><label>الهاتف</label><input type="text" id="inPhone" class="req"></div>
            <div><label>الإيميل</label><input type="email" id="inEmail" class="req"></div>
            <div><label>الميلاد</label><input type="text" id="inBirth"></div>
        </div>
        <div class="grid">
            <div><label>العنوان</label><input type="text" id="inAddress"></div>
            <div><label>الموقف من التجنيد</label><input type="text" id="inMilitary"></div>
            <div><label>الصورة</label><input type="file" id="inPhoto" accept="image/*"></div>
        </div>
        <div><label>النبذة (AI)</label><textarea id="inAbout" rows="4"></textarea></div>
        <div style="margin-top:10px;"><label>الخبرات (AI)</label><textarea id="inExp" rows="4"></textarea></div>
        <div class="grid" style="margin-top:10px;">
            <div><label>المهارات</label><textarea id="inSkills" rows="2"></textarea></div>
            <div><label>اللغات</label><textarea id="inLang" rows="2"></textarea></div>
        </div>

        <div class="dl-buttons">
            <button class="btn ar" onclick="handleDownload('ar')">تحميل بالعربية</button>
            <button class="btn en" onclick="handleDownload('en')">Download English</button>
            <button class="btn fr" onclick="handleDownload('fr')">Télécharger FR</button>
            <button class="btn it" onclick="handleDownload('it')">Scaricare IT</button>
            <button class="btn es" onclick="handleDownload('es')">Descargar ES</button>
            <button class="btn de" onclick="handleDownload('de')">Herunterladen DE</button>
        </div>
    </div>
</div>

<div id="pdf-render">
    <div class="pdf-side">
        <div style="width:100px; height:100px; border-radius:15px; border:3px solid #38bdf8; margin:0 auto 20px; overflow:hidden;">
            <img id="outPhoto" style="width:100%; height:100%; object-fit:cover;">
        </div>
        <div id="side-content"></div>
    </div>
    <div class="pdf-main">
        <h1 id="outName" style="margin:0;"></h1>
        <h3 id="outJob" style="color:#38bdf8; margin:5px 0 20px;"></h3>
        <div class="pdf-h" id="h-about"></div>
        <div id="outAbout" style="font-size:12px; line-height:1.6; white-space:pre-line;"></div>
        <div class="pdf-h" id="h-exp"></div>
        <div id="outExp" style="font-size:12px; line-height:1.6; white-space:pre-line;"></div>
    </div>
</div>

<script>
    // ترجمة العناوين الثابتة
    const ui = {
        ar: { contact: "تواصل", about: "الملف الشخصي", exp: "الخبرة المهنية", birth: "الميلاد", military: "التجنيد", skills: "المهارات", lang: "اللغات", wait: "جاري الترجمة والتحميل..." },
        en: { contact: "Contact", about: "Profile Summary", exp: "Experience", birth: "Birth", military: "Military", skills: "Skills", lang: "Languages", wait: "Translating & Downloading..." },
        fr: { contact: "Contact", about: "Résumé", exp: "Expérience", birth: "Naissance", military: "Service", skills: "Compétences", lang: "Langues", wait: "Traduction en cours..." },
        it: { contact: "Contatti", about: "Profilo", exp: "Esperienza", birth: "Nascita", military: "Militare", skills: "Abilità", lang: "Lingue", wait: "Traduzione..." },
        es: { contact: "Contacto", about: "Perfil", exp: "Experiencia", birth: "Nacimiento", military: "Militar", skills: "Habilidades", lang: "Idiomas", wait: "Traduciendo..." },
        de: { contact: "Kontakt", about: "Profil", exp: "Erfahrung", birth: "Geburt", military: "Militär", skills: "Skills", lang: "Sprachen", wait: "Übersetzung..." }
    };

    function runAI() {
        const job = document.getElementById('inJob').value || "خبير";
        const years = document.getElementById('inExpYears').value || "5";
        document.getElementById('inAbout').value = `أنا ${job} متميز أمتلك خبرة واسعة في تطوير حلول مبتكرة.\nأركز دائماً على تحقيق أعلى مستويات الجودة في العمل.\nلدي مهارات تواصل قوية وقدرة على قيادة فرق العمل.\nأطمح للمساهمة في نجاح مؤسستكم من خلال مهاراتي.\nأؤمن بالتعلم المستمر ومواكبة كل جديد.`;
        document.getElementById('inExp').value = `• خبرة تزيد عن ${years} سنوات في مجال ${job}.\n• إدارة المشاريع بنجاح وتحقيق أهداف الشركة.\n• تطوير استراتيجيات أدت لتحسين الكفاءة العامة.\n• مهارات متقدمة في حل المشكلات التقنية والإدارية.`;
        document.getElementById('inSkills').value = "القيادة، إدارة الوقت، حل المشكلات، مهارات تقنية";
        document.getElementById('inLang').value = "العربية، الإنجليزية";
    }

    // محرك الترجمة الفورية (API)
    async function translateText(text, targetLang) {
        if (!text || targetLang === 'ar') return text;
        try {
            const res = await fetch(`https://translate.googleapis.com/translate_a/single?client=gtx&sl=ar&tl=${targetLang}&dt=t&q=${encodeURI(text)}`);
            const data = await res.json();
            return data[0].map(s => s[0]).join('');
        } catch { return text; }
    }

    async function handleDownload(lang) {
        const reqs = document.querySelectorAll('.req');
        let empty = false;
        reqs.forEach(r => { if(!r.value) { r.style.borderColor = 'red'; empty = true; } else r.style.borderColor = '#e2e8f0'; });
        if(empty) return alert("أكمل البيانات أولاً!");

        document.getElementById('overlay').style.display = 'flex';
        document.getElementById('wait-msg').innerText = ui[lang].wait;

        const target = lang;
        // ترجمة المحتوى المكتوب
        const tName = await translateText(document.getElementById('inName').value, target);
        const tJob = await translateText(document.getElementById('inJob').value, target);
        const tAbout = await translateText(document.getElementById('inAbout').value, target);
        const tExp = await translateText(document.getElementById('inExp').value, target);
        const tAddr = await translateText(document.getElementById('inAddress').value, target);
        const tMili = await translateText(document.getElementById('inMilitary').value, target);
        const tSkills = await translateText(document.getElementById('inSkills').value, target);
        const tLang = await translateText(document.getElementById('inLang').value, target);

        // تعبئة الـ PDF
        const pdf = document.getElementById('pdf-render');
        pdf.className = (lang === 'ar') ? 'rtl' : 'ltr';
        document.getElementById('outName').innerText = tName;
        document.getElementById('outJob').innerText = tJob;
        document.getElementById('outAbout').innerText = tAbout;
        document.getElementById('outExp').innerText = tExp;
        document.getElementById('h-about').innerText = ui[lang].about;
        document.getElementById('h-exp').innerText = ui[lang].exp;

        document.getElementById('side-content').innerHTML = `
            <div style="color:#38bdf8; font-weight:900; border-bottom:1px solid #444; margin-bottom:10px;">${ui[lang].contact}</div>
            <div style="font-size:11px; margin-bottom:5px;"><i class="fas fa-phone"></i> ${document.getElementById('inPhone').value}</div>
            <div style="font-size:11px; margin-bottom:15px;"><i class="fas fa-envelope"></i> ${document.getElementById('inEmail').value}</div>
            <div style="font-size:11px; margin-bottom:15px;"><b>${ui[lang].birth}:</b> ${document.getElementById('inBirth').value}</div>
            <div style="font-size:11px; margin-bottom:15px;"><b>${ui[lang].military}:</b> ${tMili}</div>
            <div style="color:#38bdf8; font-weight:900; border-bottom:1px solid #444; margin:20px 0 10px;">${ui[lang].skills}</div>
            <div style="font-size:11px; white-space:pre-line;">${tSkills}</div>
            <div style="color:#38bdf8; font-weight:900; border-bottom:1px solid #444; margin:20px 0 10px;">${ui[lang].lang}</div>
            <div style="font-size:11px;">${tLang}</div>
        `;

        setTimeout(async () => {
            const canvas = await html2canvas(pdf, { scale: 3 });
            const doc = new jspdf.jsPDF('p', 'mm', 'a4');
            doc.addImage(canvas.toDataURL('image/png'), 'PNG', 0, 0, 210, 297);
            doc.save(`CV_${tName}_${lang}.pdf`);
            document.getElementById('overlay').style.display = 'none';
        }, 500);
    }

    document.getElementById('inPhoto').onchange = e => {
        const reader = new FileReader();
        reader.onload = () => document.getElementById('outPhoto').src = reader.result;
        reader.readAsDataURL(e.target.files[0]);
    };
</script>
</body>
</html>
